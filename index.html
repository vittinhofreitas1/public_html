<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Easy Flap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            touch-action: manipulation;
        }
        .text-shadow {
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        }
        canvas {
            background-color: #87CEEB; /* Cor do céu */
            display: block;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 500px;
            border-radius: 12px;
        }
        .emergency-button {
            transition: all 0.3s ease;
        }
        .emergency-button:active {
            transform: scale(0.95);
            box-shadow: 0 0 20px 10px rgba(239, 68, 68, 0.5);
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Tela do Jogo (Disfarce) -->
    <div id="game-screen" class="min-h-screen bg-cyan-600 flex flex-col items-center justify-center p-4 overflow-hidden">
        <div class="w-full max-w-sm mx-auto flex justify-between items-center mb-2 z-10">
            <h2 class="text-3xl font-bold text-white text-shadow">Pontos: <span id="score">0</span></h2>
            <button id="settings-button" class="p-2 bg-white/70 rounded-full shadow hover:bg-white transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-cyan-800" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
            </button>
        </div>
        <canvas id="game-canvas" width="320" height="480"></canvas>
        <p id="start-message" class="text-white font-bold mt-4 z-10 text-shadow">Toque na tela para começar</p>
    </div>

    <!-- Modal de Configurações (Gatilho Secreto) -->
    <div id="settings-modal" class="modal">
        <div class="modal-content bg-cyan-50">
            <h2 class="text-2xl font-bold text-center mb-6 text-cyan-800">Configurações</h2>
            <div class="mb-4">
                <label for="player-name" class="block text-cyan-700 text-sm font-bold mb-2">Nome do Jogador:</label>
                <input type="text" id="player-name" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Digite seu nome ou código">
                <p id="error-message" class="text-red-500 text-xs italic mt-2 hidden">Código incorreto.</p>
            </div>
            <div class="flex items-center justify-between">
                <button id="close-modal-button" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition">
                    Fechar
                </button>
                <button id="save-settings-button" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition">
                    Salvar
                </button>
            </div>
        </div>
    </div>

    <!-- Tela Segura (Acesso após senha) -->
    <div id="secure-screen" class="hidden min-h-screen bg-gray-800 text-white p-4">
        <div class="max-w-md mx-auto">
            <div class="text-center my-6">
                <h1 class="text-2xl font-bold text-purple-300">Você não está sozinha.</h1>
                <p class="text-purple-100 mt-2">Este é o seu espaço seguro. Estamos aqui para ajudar.</p>
            </div>
            <div class="my-8">
                <button id="emergency-button" class="emergency-button w-full bg-red-600 text-white font-bold text-xl py-6 rounded-full shadow-lg hover:bg-red-700 focus:outline-none focus:ring-4 focus:ring-red-400 focus:ring-opacity-75">
                    PEDIR AJUDA AGORA
                </button>
                <p class="text-center text-xs text-gray-400 mt-2">Use apenas em caso de emergência real. Ação silenciosa será iniciada.</p>
            </div>
            <div class="space-y-4">
                <div class="bg-gray-700 p-4 rounded-lg flex items-center space-x-4 hover:bg-gray-600 cursor-pointer transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-300" viewBox="0 0 20 20" fill="currentColor"><path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z" /><path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h7a2 2 0 002-2V9a2 2 0 00-2-2h-1z" /></svg>
                    <div>
                        <h3 class="font-semibold">Comunidade de Apoio</h3>
                        <p class="text-sm text-gray-300">Leia relatos e compartilhe sua história anonimamente.</p>
                    </div>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex items-center space-x-4 hover:bg-gray-600 cursor-pointer transition">
                     <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-300" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" /></svg>
                    <div>
                        <h3 class="font-semibold">Meu Cofre de Provas</h3>
                        <p class="text-sm text-gray-300">Guarde fotos, áudios e vídeos com segurança.</p>
                    </div>
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex items-center space-x-4 hover:bg-gray-600 cursor-pointer transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-300" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" /></svg>
                    <div>
                        <h3 class="font-semibold">Mapa de Acolhimento</h3>
                        <p class="text-sm text-gray-300">Encontre delegacias e abrigos próximos.</p>
                    </div>
                </div>
            </div>
             <button id="exit-secure-button" class="mt-8 w-full bg-gray-600 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition">
                Sair da Área Segura
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Elementos da UI
            const settingsButton = document.getElementById('settings-button');
            const settingsModal = document.getElementById('settings-modal');
            const closeModalButton = document.getElementById('close-modal-button');
            const saveSettingsButton = document.getElementById('save-settings-button');
            const playerNameInput = document.getElementById('player-name');
            const errorMessage = document.getElementById('error-message');
            const gameScreen = document.getElementById('game-screen');
            const secureScreen = document.getElementById('secure-screen');
            const exitSecureButton = document.getElementById('exit-secure-button');
            const startMessage = document.getElementById('start-message');
            const scoreDisplay = document.getElementById('score');

            // Configurações do Jogo
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            let bird, pipes, score, gravity, lift, gameLoop;
            let gameStarted = false;
            let gameIsOver = false;

            function setupGame() {
                bird = { x: 50, y: canvas.height / 2, radius: 15, velocity: 0 };
                pipes = [];
                score = 0;
                gravity = 0.4;
                lift = -8;
                gameIsOver = false;
                scoreDisplay.textContent = '0';
                startMessage.textContent = 'Toque na tela para começar';
                startMessage.style.display = 'block';
                
                // Limpa o primeiro cano se existir
                pipes.push({ x: canvas.width, y: 0, width: 50, gap: 180 });
                drawInitialState();
            }

            function drawInitialState() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                // Desenha o chão
                ctx.fillStyle = '#588157';
                ctx.fillRect(0, canvas.height - 20, canvas.width, 20);
                // Desenha o pássaro
                ctx.beginPath();
                ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
                ctx.fillStyle = '#fca311'; // Cor do pássaro
                ctx.fill();
                ctx.closePath();
            }

            function startGameLoop() {
                if (gameLoop) clearInterval(gameLoop);
                gameLoop = setInterval(updateGame, 1000 / 60); // 60 FPS
            }
            
            function updateGame() {
                // Limpa o canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Pássaro
                bird.velocity += gravity;
                bird.y += bird.velocity;

                // Colisão com chão ou teto
                if (bird.y + bird.radius > canvas.height - 20 || bird.y - bird.radius < 0) {
                    gameOver();
                    return;
                }

                // Canos
                for (let i = pipes.length - 1; i >= 0; i--) {
                    let p = pipes[i];
                    p.x -= 2; // Velocidade dos canos

                    // Desenha os canos
                    ctx.fillStyle = '#3a5a40'; // Cor do cano
                    ctx.fillRect(p.x, p.y, p.width, canvas.height);
                    ctx.clearRect(p.x, p.y + (canvas.height - p.gap) / 2, p.width, p.gap);
                    
                    // Colisão com canos
                    if (bird.x + bird.radius > p.x && bird.x - bird.radius < p.x + p.width &&
                        (bird.y - bird.radius < (p.y + (canvas.height - p.gap) / 2) || bird.y + bird.radius > (p.y + (canvas.height - p.gap) / 2 + p.gap))) {
                         gameOver();
                         return;
                    }

                    // Pontuação
                    if (p.x + p.width < bird.x && !p.passed) {
                        score++;
                        scoreDisplay.textContent = score;
                        p.passed = true;
                    }

                    // Remove canos que saíram da tela
                    if (p.x + p.width < 0) {
                        pipes.splice(i, 1);
                    }
                }
                
                // Adiciona novos canos
                if (pipes[pipes.length - 1].x < canvas.width - 200) {
                    pipes.push({
                        x: canvas.width,
                        y: 0,
                        width: 50,
                        gap: 180,
                        passed: false
                    });
                }
                
                // Desenha o chão
                ctx.fillStyle = '#588157';
                ctx.fillRect(0, canvas.height - 20, canvas.width, 20);

                // Desenha o pássaro
                ctx.beginPath();
                ctx.arc(bird.x, bird.y, bird.radius, 0, Math.PI * 2);
                ctx.fillStyle = '#fca311';
                ctx.fill();
                ctx.closePath();
            }

            function gameOver() {
                clearInterval(gameLoop);
                gameIsOver = true;
                startMessage.textContent = 'Fim de Jogo! Toque para reiniciar.';
                startMessage.style.display = 'block';
            }

            function handleUserAction() {
                if (!gameStarted) {
                    gameStarted = true;
                    startMessage.style.display = 'none';
                    startGameLoop();
                }
                if (gameIsOver) {
                    gameStarted = false;
                    setupGame();
                } else {
                    bird.velocity = lift;
                }
            }
            
            canvas.addEventListener('mousedown', handleUserAction);
            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault(); // Previne o clique duplo do mouse em mobile
                handleUserAction();
            });

            // --- Lógica do Disfarce e Tela Segura ---
            settingsButton.addEventListener('click', () => {
                settingsModal.style.display = 'block';
                clearInterval(gameLoop); // Pausa o jogo
            });

            closeModalButton.addEventListener('click', () => {
                settingsModal.style.display = 'none';
                playerNameInput.value = '';
                errorMessage.classList.add('hidden');
                if(gameStarted && !gameIsOver) startGameLoop(); // Retoma o jogo
            });

            saveSettingsButton.addEventListener('click', () => {
                const secretCode = "Acolher123";
                if (playerNameInput.value.trim() === secretCode) {
                    settingsModal.style.display = 'none';
                    playerNameInput.value = '';
                    gameScreen.classList.add('hidden');
                    secureScreen.classList.remove('hidden');
                    clearInterval(gameLoop);
                } else {
                    errorMessage.classList.remove('hidden');
                    setTimeout(() => errorMessage.classList.add('hidden'), 3000);
                }
            });
            
            exitSecureButton.addEventListener('click', () => {
                secureScreen.classList.add('hidden');
                gameScreen.classList.remove('hidden');
                gameStarted = false;
                setupGame(); // Reinicia o jogo ao sair da área segura
            });

            window.onclick = function(event) {
                if (event.target == settingsModal) {
                    settingsModal.style.display = "none";
                    if(gameStarted && !gameIsOver) startGameLoop(); // Retoma o jogo
                }
            }

            // Inicia o jogo no estado inicial
            setupGame();
        });
    </script>

</body>
</html>
